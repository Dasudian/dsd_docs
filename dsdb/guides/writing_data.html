<!DOCTYPE html>
<html lang="zh">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="大数点物联网开发者平台文档，基于大数点物联网平台，帮助开发者快速构建物联网应用">
    <title>Writing Data</title>
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/app.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/highlight.js/9.2.0/styles/dark.min.css" rel="stylesheet">
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/common.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
    <script>
      $(function() {
        // $(".document .side_left ul li a").click(function() {
        //   $(".document .side_left ul li a").removeClass("active");
        //   $(this).addClass("active");
        // })
        $(".menu1>li>a.fold").click(function(){
				  $(".menu1 a.fold").css("background-image","url(/images/number_down.png)");
				  $(".menu2,.menu3").slideUp();
			  })
			  $(".menu2>li>a.fold").click(function(){
          $(".menu2 a.fold").css("background-image","url(/images/number_down.png)");
          $(".menu3").slideUp();
        })
        $(".fold").click(function() {
          if ($(this).next("ul").is(":hidden")) {
            $(this).css("background-image", "url(/images/number_up.png)");
            $(this).next("ul").slideDown();
          } else {
            $(this).css("background-image", "url(/images/number_down.png)");
            $(this).next("ul").slideUp();
          }
        })
      })
      $(function(){
			  $(".side_right").scroll( function() { 
				  var scrollValue=$(".side_right").scrollTop();
				  scrollValue > 100 ? $('div[class=scroll]').fadeIn():$('div[class=scroll]').fadeOut();
			  });	
			  $('#scroll').click(function(){
				  $(".side_right").animate({scrollTop:0},200);	
			  });	
		  })
    </script>
    <link href='http://fonts.useso.com/css?family=Open+Sans:300|Source+Code+Pro:400' rel='stylesheet' type='text/css'>
  </head>

  <body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><img src="/images/logo.png"/></a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="http://dasudian.com/solution" >解决方案</a></li>
            <li><a href="/" >文档</a></li>
            <li><a href="http://dasudian.com/price" >定价</a></li>
            <li><a href="https://www.github.com/Dasudian"  target="_blank" >社区</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid0 document">
      <div class="side_left">
        <ul class="menu1">
          <li><a class="fold">服务集成指南</a>
            <ul class="menu2" >
              <li><a id="srvintegrate-im-android" class="" href="/integration-dev/integrate-im-android.html">Android上集成IM功能</a></li>
              <li><a id="srvintegrate-im-ios" class="" href="/integration-dev/integrate-im-ios.html">iOS上集成IM功能</a></li>
            </ul>
          </li>
          <li><a class="fold">DS Database</a>
            <ul class="menu2" style="display: block;">
              <li><a id="dsdb-overview" class="" href="/dsdb/index.html">DSDB Overview</a></li>
              <li><a class="fold">Introduction</a>
                <ul class="menu3" >
                  <li><a id="dsdb-intro-overview" class="" href="/dsdb/introduction/index.html">Overview</a></li>
                  <li><a id="dsdb-intro-installation" class="" href="/dsdb/introduction/installation.html">Installation</a></li>
                  <li><a id="dsdb-intro-start" class="" href="/dsdb/introduction/getting_started.html">Getting Started</a></li>
                </ul>
              </li>
              <li><a class="fold">Administration</a>
                <ul class="menu3" >
                  <li><a id="dsdb-admin-overview" class="" href="/dsdb/administration/index.html">administration Overview</a></li>
                  <li><a id="dsdb-authent&amp;authori" class="" href="/dsdb/administration/authentication_and_authorization.html">Authentication&Authorization</a></li>
                  <li><a id="dsdb-backup&amp;restore" class="" href="/dsdb/administration/backup_and_restore.html">Backup&Restore</a></li>
                  <li><a id="dsdb-configuration" class="" href="/dsdb/administration/config.html">Configuration</a></li>
                  <li><a id="dsdb-logs" class="" href="/dsdb/administration/logs.html">Logs</a></li>
                  <li><a id="dsdb-monitoring" class="" href="/dsdb/administration/statistics.html">Server Monitoring</a></li>
                  <li><a id="dsdb-upgrade" class="" href="/dsdb/administration/upgrading.html">Upgrading</a></li>
                </ul>
              </li>
              <li><a class="fold">Clients</a>
                <ul class="menu3" >
                  <li><a id="dsdb-clients-overview" class="" href="/dsdb/clients/index.html">Clients Overview</a></li>
                  <li><a id="dsdb-clients-httpapi" class="" href="/dsdb/clients/api.html">HTTP API</a></li>
                </ul>
              </li>
              <li><a class="fold">Concepts</a>
                <ul class="menu3" >
                  <li><a id="dsdb-concepts-overview" class="" href="/dsdb/concepts/index.html">Concepts Overview</a></li>
                  <li><a id="dsdb-key-concepts" class="" href="/dsdb/concepts/key_concepts.html">Key Concepts</a></li>
                  <li><a id="dsdb-concepts-arch" class="" href="/dsdb/concepts/how_dsdb_works.html">Architecture</a></li>
                  <li><a id="dsdb-concepts-schema-data-layout" class="" href="/dsdb/concepts/schema_and_data_layout.html">Scheam Design</a></li>
                  <li><a id="dsdb-concepts-insights-tradeoffs" class="" href="/dsdb/concepts/insights_tradeoffs.html">Insights Tradeoffs</a></li>
                  <li><a id="dsdb-concepts-api-endpoints" class="" href="/dsdb/concepts/api.html">API Endpoints&Ports</a></li>
                  <li><a id="dsdb-concepts-storage-engine" class="" href="/dsdb/concepts/storage_engine.html">Storage Engine</a></li>
                  <li><a id="dsdb-concepts-glossary" class="" href="/dsdb/concepts/glossary.html">Glossary of Terms</a></li>
                  <li><a id="dsdb-concepts-vs-sql" class="" href="/dsdb/concepts/crosswalk.html">Comparison to SQL</a></li>
                </ul>
              </li>
              <li><a class="fold">Data Sources</a>
                <ul class="menu3" >
                  <li><a id="dsdb-datasource-diamond" class="" href="/dsdb/data_sources/diamond.html">Diamond</a></li>
                  <li><a id="dsdb-datasource-opentsdb" class="" href="/dsdb/data_sources/opentsdb.html">OpenTSDB</a></li>
                  <li><a id="dsdb-datasource-carbon" class="" href="/dsdb/data_sources/carbon.html">Carbon</a></li>
                  <li><a id="dsdb-datasource-collectd" class="" href="/dsdb/data_sources/collectd.html">Collectd</a></li>
                </ul>
              </li>
              <li><a class="fold">Guides</a>
                <ul class="menu3" style="display: block;">
                  <li><a id="dsdb-guides-clustering" class="" href="/dsdb/guides/clustering.html">Clustering</a></li>
                  <li><a id="dsdb-guides-ddr" class="" href="/dsdb/guides/downsampling_and_retention.html">Downsampling and Data Retention</a></li>
                  <li><a id="dsdb-guides-hsg" class="" href="/dsdb/guides/hardware_sizing.html">Hardware Sizing Guidelines</a></li>
                  <li><a id="dsdb-guides-querying" class="" href="/dsdb/guides/querying_data.html">Querying Data</a></li>
                  <li><a id="dsdb-guides-writing" class="active" href="/dsdb/guides/writing_data.html">Writing Data</a></li>
                </ul>
              </li>
              <li><a class="fold">Query Language</a>
                <ul class="menu3" >
                  <li><a id="dsdb-querylang-overview" class="" href="/dsdb/query_language/index.html">Overview</a></li>
                  <li><a id="dsdb-querylang-dataexp" class="" href="/dsdb/query_language/data_exploration.html">Data Exploration</a></li>
                  <li><a id="dsdb-querylang-scheamexp" class="" href="/dsdb/query_language/schema_exploration.html">Schema Exploration</a></li>
                  <li><a id="dsdb-querylang-func" class="" href="/dsdb/query_language/functions.html">Functions</a></li>
                  <li><a id="dsdb-querylang-contq" class="" href="/dsdb/query_language/continuous_queries.html">Continuous Queries</a></li>
                  <li><a id="dsdb-querylang-spec" class="" href="/dsdb/query_language/spec.html">Query Language Reference</a></li>
                  <li><a id="dsdb-querylang-mgmt" class="" href="/dsdb/query_language/database_management.html">Database Management</a></li>
                  <li><a id="dsdb-querylang-math" class="" href="/dsdb/query_language/math_operators.html">Mathematical Operators</a></li>
                </ul>
              </li>
              <li><a class="fold">Sample Data</a>
                <ul class="menu3" >
                  <li><a id="dsdb-sampledata-down" class="" href="/dsdb/sample_data/data_download.html">Sample Data Download</a></li>
                </ul>
              </li>
              <li><a class="fold">Tools</a>
                <ul class="menu3" >
                  <li><a id="dsdb-tools-overview" class="" href="/dsdb/tools/index.html">Tools Overview</a></li>
                  <li><a id="dsdb-tools-shell" class="" href="/dsdb/tools/shell.html">CLI/Shell</a></li>
                  <li><a id="dsdb-tools-webadmin" class="" href="/dsdb/tools/web_admin.html">Web Admin Interface</a></li>
                  <li><a id="dsdb-tools-grafana" class="" href="/dsdb/tools/grafana.html">Grafana Dashboards</a></li>
                  <li><a id="dsdb-tools-telegraf" class="" href="/dsdb/tools/telegraf.html">Telegraf Metrics Collection</a></li>
                  <li><a id="dsdb-tools-chronograf" class="" href="/dsdb/tools/chronograf.html">Chronograf Dashboards</a></li>
                  <li><a id="dsdb-tools-kapacitor" class="" href="/dsdb/tools/kapacitor.html">Kapacitor Monitoring</a></li>
                </ul>
              </li>
              <li><a class="fold">Write Protocols</a>
                <ul class="menu3" >
                  <li><a id="dsdb-writepro-overview" class="" href="/dsdb/write_protocols/index.html">Overview</a></li>
                  <li><a id="dsdb-writepro-line" class="" href="/dsdb/write_protocols/line.html">Line Protocol</a></li>
                  <li><a id="dsdb-writepro-syntax" class="" href="/dsdb/write_protocols/write_syntax.html">Write Syntax</a></li>
                  <li><a id="dsdb-writepro-json" class="" href="/dsdb/write_protocols/json.html">JSON Protocol</a></li>
                  <li><a id="dsdb-writepro-udp" class="" href="/dsdb/write_protocols/udp.html">Service - UDP</a></li>
                  <li><a id="dsdb-writepro-graphite" class="" href="/dsdb/write_protocols/graphite.html">Service - Graphite</a></li>
                  <li><a id="dsdb-writepro-opentsdb" class="" href="/dsdb/write_protocols/opentsdb.html">Servcie - OpenTSDB</a></li>
                  <li><a id="dsdb-writepro-collectd" class="" href="/dsdb/write_protocols/collectd.html">Service - CollectD</a></li>
                </ul>
              </li>
              <li><a class="fold">Troubleshooting</a>
                <ul class="menu3" >
                  <li><a id="dsdb-troubleshoot-overview" class="" href="/dsdb/troubleshooting/index.html">Troubleshooting Overview</a></li>
                  <li><a id="dsdb-troubleshoot-fei" class="" href="/dsdb/troubleshooting/frequently_encountered_issues.html">Frequently Encountered Issues</a></li>
                  <li><a id="dsdb-troubleshoot-monitor" class="" href="/dsdb/troubleshooting/system_monitoring.html">System Monitoring</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li><a class="fold">DSD API Container(DAC)</a>
            <ul class="menu2" >
              <li><a id="dac-principal" class="" href="/dac/index.html">DAC介绍</a></li>
              <li><a id="dac-java-api" class="" href="/dac/dac_cloud_api_java.html">DAC Java API</a></li>
              <li><a id="dac-c-api" class="" href="/dac/dac_cloud_api_c.html">DAC C API</a></li>
              <li><a id="dac-cpp-api" class="" href="/dac/dac_cloud_api_cpp.html">DAC C++ API</a></li>
            </ul>
          </li>
          <li><a class="fold">Data Hub</a>
            <ul class="menu2" >
              <li><a class="fold">SDK</a>
                <ul class="menu3" >
                  <li><a id="datahub-sdk-js" class="" href="/data-hub/sdk/javascript.html">JavaScript</a></li>
                  <li><a id="datahub-sdk-embededc" class="" href="/data-hub/sdk/embeded_c.html">Embeded C</a></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
    </div>

    <div class="side_right">
      <div class="doc">
        <h1 id="writing-data">Writing Data</h1>
<p>There are many ways to write data into DSDB including the <a href="/docs/dsdb/tools/shell.html">command line interface</a>, <a href="/docs/dsdb/clients/api.html">client libraries</a> and plugins for common data formats such as <a href="/docs/dsdb/write_protocols/graphite.html">Graphite</a>.
Here we'll show you how to create a database and write data to that database using the built-in HTTP API.</p>
<h2 id="creating-a-database-using-the-http-api">Creating a database using the HTTP API</h2>
<p>To create a database send a <code>GET</code> request to the <code>/query</code> endpoint and set the URL parameter <code>q</code> to <code>CREATE DATABASE &lt;new_database_name&gt;</code>.
The example below sends a request to DSDB running on <code>localhost</code> and creates the database <code>mydb</code>:<br />
<br></p>
<pre><code class="language-sh">curl -G http://localhost:8088/query --data-urlencode "q=CREATE DATABASE mydb"</code></pre>
<h2 id="writing-data-using-the-http-api">Writing data using the HTTP API</h2>
<p>The HTTP API is the primary means of putting data into DSDB.
To write data send a <code>POST</code> request to the <code>/write</code> endpoint.
The example below writes a single point to the <code>mydb</code> database.
The data consist of the <a href="/docs/dsdb/concepts/glossary.html#measurement">measurement</a> <code>cpu_load_short</code>, the <a href="/docs/dsdb/concepts/glossary.html#tag-key">tag keys</a> <code>host</code> and <code>region</code> with the <a href="/docs/dsdb/concepts/glossary.html#tag-value">tag values</a> <code>server01</code> and <code>us-west</code>, the <a href="/docs/dsdb/concepts/glossary.html#field-key">field key</a> <code>value</code> with a <a href="/docs/dsdb/concepts/glossary.html#field-value">field value</a> of <code>0.64</code>, and the <a href="/docs/dsdb/concepts/glossary.html#timestamp">timestamp</a> <code>1434055562000000000</code>.
<br></p>
<pre><code class="language-sh">curl -i -XPOST 'http://localhost:8088/write?db=mydb' --data-binary 'cpu_load_short,host=server01,region=us-west value=0.64 1434055562000000000'</code></pre>
<p>When writing points, you must specify an existing database in the <code>db</code> query parameter.
See the <a href="/docs/dsdb/write_protocols/write_syntax.html#http">HTTP section</a> on the Write Syntax page for a complete list of the available query parameters.</p>
<p>The body of the POST - we call this the <a href="/docs/dsdb/write_protocols/line.html">Line Protocol</a> - contains the time-series data that you wish to store.
They consist of a measurement, tags, fields, and a timestamp.
DSDB requires a measurement name.
Strictly speaking, tags are optional but most series include tags to differentiate data sources and to make querying both easy and efficient.
Both tag keys and tag values are strings.
Field keys are required and are always strings, and, <a href="/docs/dsdb/write_protocols/write_syntax.html#line-protocol">by default</a>, field values are floats.
The timestamp - supplied at the end of the line in Unix time in nanoseconds since January 1, 1970 UTC - is optional.
If you do not specify a timestamp DSDB uses the server's local nanosecond timestamp in Unix epoch.
Anything that has to do with time in DSDB is always UTC.</p>
<h3 id="writing-multiple-points">Writing multiple points</h3>
<hr />
<p>Post multiple points to multiple series at the same time by separating each point with a new line.
Batching points in this manner results in much higher performance.</p>
<p>The following example writes three points to the database <code>mydb</code>.
The first point belongs to the series with the measurement <code>cpu_load_short</code> and tag set <code>host=server02</code> and has the server's local timestamp.
The second point belongs to the series with the measurement <code>cpu_load_short</code> and tag set <code>host=server02,region=us-west</code> and has the specified timestamp <code>1422568543702900257</code>.
The third point has the same specified timestamp as the second point, but it is written to the series with the measurement <code>cpu_load_short</code> and tag set <code>direction=in,host=server01,region=us-west</code>.
<br></p>
<pre><code class="language-sh">curl -i -XPOST 'http://localhost:8088/write?db=mydb' --data-binary 'cpu_load_short,host=server02 value=0.67
cpu_load_short,host=server02,region=us-west value=0.55 1422568543702900257
cpu_load_short,direction=in,host=server01,region=us-west value=2.0 1422568543702900257'</code></pre>
<h3 id="writing-points-from-a-file">Writing points from a file</h3>
<hr />
<p>Write points from a file by passing <code>@filename</code> to <code>curl</code>.
The data in the file should follow DSDB's <a href="/docs/dsdb/write_protocols/write_syntax.html">line protocol syntax</a>.</p>
<p>Example of a properly-formatted file (<code>cpu_data.txt</code>):<br />
<br></p>
<pre><code class="language-txt">cpu_load_short,host=server02 value=0.67
cpu_load_short,host=server02,region=us-west value=0.55 1422568543702900257
cpu_load_short,direction=in,host=server01,region=us-west value=2.0 1422568543702900257</code></pre>
<p>Write the data in <code>cpu_data.txt</code> to the <code>mydb</code> database with:<br />
<br>
<code>curl -i -XPOST 'http://localhost:8088/write?db=mydb' --data-binary @cpu_data.txt</code></p>
<blockquote>
<p><strong>Note:</strong> If your data file has more than 5,000 points, it may be necessary to split that file into several files in order to write your data in batches to DSDB.
<a href="/docs/dsdb/administration/config.html#cluster">By default</a>, the HTTP request times out after five seconds.
DSDB will still attempt to write the points after that time out but there will be no confirmation that they were successfully written.</p>
</blockquote>
<h3 id="schemaless-design">Schemaless Design</h3>
<hr />
<p>DSDB is a schemaless database.
You can add new measurements, tags, and fields at any time.
Note that if you attempt to write data with a different type than previously used (for example, writing a string to a field that previously accepted integers), DSDB will reject those data.</p>
<h3 id="a-note-on-rest">A note on REST...</h3>
<hr />
<p>DSDB uses HTTP solely as a convenient and widely supported data transfer protocol.</p>
<p>Modern web APIs have settled on REST because it addresses a common need.
As the number of endpoints grows the need for an organizing system becomes pressing.
REST is the industry agreed style for organizing large numbers of endpoints.
This consistency is good for those developing and consuming the API: everyone involved knows what to expect.</p>
<p>REST, however, is a convention.
DSDB makes do with three API endpoints.
This simple, easy to understand system uses HTTP as a transfer system for <a href="https://github.com/docs/dsdb/dsdb/blob/master/influxql/influxql.html">DSDBQL</a>.
The DSDB API makes no attempt to be RESTful.</p>
<h3 id="http-response-summary">HTTP response summary</h3>
<hr />
<ul>
<li>2xx: If it's <code>HTTP 204 No Content</code>, success!
If it's  <code>HTTP 200 OK</code>, DSDB understood the request but couldn't complete it.
The body of the response will contain additional error information.</li>
<li>4xx: DSDB could not understand the request.</li>
<li>5xx: The system is overloaded or significantly impaired.</li>
</ul>
<p><strong>Examples of error responses:</strong></p>
<ul>
<li>Writing a float to a field that previously accepted booleans:</li>
</ul>
<pre><code class="language-sh">curl -i -XPOST 'http://localhost:8088/write?db=hamlet' --data-binary 'tobeornottobe booleanonly=true'  

curl -i -XPOST 'http://localhost:8088/write?db=hamlet' --data-binary 'tobeornottobe booleanonly=5'</code></pre>
<p>returns:<br />
<br></p>
<pre><code class="language-sh">HTTP/1.1 400 Bad Request
[...]
write failed: field type conflict: input field "booleanonly" on measurement "tobeornottobe" is type float64, already exists as type boolean</code></pre>
<ul>
<li>Writing a point to a database that doesn't exist:</li>
</ul>
<pre><code class="language-sh">curl -i -XPOST 'http://localhost:8088/write?db=atlantis' --data-binary 'liters value=10'</code></pre>
<p>returns:<br />
<br></p>
<pre><code class="language-sh">HTTP/1.1 404 Not Found
[...]
database not found: "atlantis"</code></pre>
<h3 id="next-steps">Next steps</h3>
<hr />
<p>Now that you know how to write data with the built-in HTTP API discover how to query them with the <a href="/docs/dsdb/guides/querying_data.html">Querying Data</a> guide!</p>
      </div>

              <div class="tract"><img src="/images/tract.png"/></div>
            <div class="clearfix"></div>
      <div class="scroll" id="scroll" style="display:none;">
			     <img src="/images/top.png"/>
		  </div>
    </div>
  </div>
  <script>hljs.initHighlightingOnLoad();</script>
</body>

</html>
