<!DOCTYPE html>
<html lang="zh">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="大数点物联网开发者平台文档，基于大数点物联网平台，帮助开发者快速构建物联网应用">
    <title>Service - UDP</title>
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/app.css" rel="stylesheet">
    <link href="/css/doc.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/highlight.js/9.2.0/styles/dark.min.css" rel="stylesheet">
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/common.js"></script>
    <script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
    <script>
      $(function() {
        // $(".document .side_left ul li a").click(function() {
        //   $(".document .side_left ul li a").removeClass("active");
        //   $(this).addClass("active");
        // })
        $(".menu1>li>a.fold").click(function(){
				  $(".menu1 a.fold").css("background-image","url(/images/number_down.png)");
				  $(".menu2,.menu3").slideUp();
			  })
			  $(".menu2>li>a.fold").click(function(){
          $(".menu2 a.fold").css("background-image","url(/images/number_down.png)");
          $(".menu3").slideUp();
        })
        $(".fold").click(function() {
          if ($(this).next("ul").is(":hidden")) {
            $(this).css("background-image", "url(/images/number_up.png)");
            $(this).next("ul").slideDown();
          } else {
            $(this).css("background-image", "url(/images/number_down.png)");
            $(this).next("ul").slideUp();
          }
        })
      })
      $(function(){
			  $(".side_right").scroll( function() { 
				  var scrollValue=$(".side_right").scrollTop();
				  scrollValue > 100 ? $('div[class=scroll]').fadeIn():$('div[class=scroll]').fadeOut();
			  });	
			  $('#scroll').click(function(){
				  $(".side_right").animate({scrollTop:0},200);	
			  });	
		  })
    </script>
    <link href='//fonts.useso.com/css?family=Open+Sans:300|Source+Code+Pro:400' rel='stylesheet' type='text/css'>
  </head>

  <body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://dev.dasudian.com"><img src="/images/logo.png"/></a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="http://dasudian.com/datahub" >IoT Data Hub</a></li>
            <li><a href="http://dasudian.com/product_service" >产品服务</a></li>
            <li><a href="/" >文档</a></li>
            <li><a href="http://dasudian.com/price" >定价</a></li>
            <li><a href="https://www.github.com/Dasudian"  target="_blank" >社区</a></li>
            <li><a href="https://dev.dasudian.com/login/view" class="btn-small">登录</a></li>
            <li><a href="https://dev.dasudian.com/sign_up/view" class="btn-small">注册</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid0 document">
      <div class="side_left">
        <ul class="menu1">
          <li><a class="fold">服务集成指南</a>
            <ul class="menu2" >
              <li><a id="srvintegrate-index" class="" href="/integration-dev/index.html">服务集成</a></li>
              <li><a class="fold">IM即时消息服务</a>
                <ul class="menu3" >
                  <li><a id="srvintegrate-im-android" class="" href="/integration-dev/im/integrate-im-android.html">Android上集成IM功能</a></li>
                  <li><a id="srvintegrate-im-ios" class="" href="/integration-dev/im/integrate-im-ios.html">iOS上集成IM功能</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li><a class="fold">DS Database</a>
            <ul class="menu2" style="display: block;">
              <li><a id="dsdb-overview" class="" href="/dsdb/index.html">DSDB Overview</a></li>
              <li><a class="fold">Introduction</a>
                <ul class="menu3" >
                  <li><a id="dsdb-intro-overview" class="" href="/dsdb/introduction/index.html">Overview</a></li>
                  <li><a id="dsdb-intro-installation" class="" href="/dsdb/introduction/installation.html">Installation</a></li>
                  <li><a id="dsdb-intro-start" class="" href="/dsdb/introduction/getting_started.html">Getting Started</a></li>
                </ul>
              </li>
              <li><a class="fold">Administration</a>
                <ul class="menu3" >
                  <li><a id="dsdb-admin-overview" class="" href="/dsdb/administration/index.html">administration Overview</a></li>
                  <li><a id="dsdb-authent&amp;authori" class="" href="/dsdb/administration/authentication_and_authorization.html">Authentication&Authorization</a></li>
                  <li><a id="dsdb-backup&amp;restore" class="" href="/dsdb/administration/backup_and_restore.html">Backup&Restore</a></li>
                  <li><a id="dsdb-configuration" class="" href="/dsdb/administration/config.html">Configuration</a></li>
                  <li><a id="dsdb-logs" class="" href="/dsdb/administration/logs.html">Logs</a></li>
                  <li><a id="dsdb-monitoring" class="" href="/dsdb/administration/statistics.html">Server Monitoring</a></li>
                  <li><a id="dsdb-upgrade" class="" href="/dsdb/administration/upgrading.html">Upgrading</a></li>
                </ul>
              </li>
              <li><a class="fold">Clients</a>
                <ul class="menu3" >
                  <li><a id="dsdb-clients-overview" class="" href="/dsdb/clients/index.html">Clients Overview</a></li>
                  <li><a id="dsdb-clients-httpapi" class="" href="/dsdb/clients/api.html">HTTP API</a></li>
                </ul>
              </li>
              <li><a class="fold">Concepts</a>
                <ul class="menu3" >
                  <li><a id="dsdb-concepts-overview" class="" href="/dsdb/concepts/index.html">Concepts Overview</a></li>
                  <li><a id="dsdb-key-concepts" class="" href="/dsdb/concepts/key_concepts.html">Key Concepts</a></li>
                  <li><a id="dsdb-concepts-arch" class="" href="/dsdb/concepts/how_dsdb_works.html">Architecture</a></li>
                  <li><a id="dsdb-concepts-schema-data-layout" class="" href="/dsdb/concepts/schema_and_data_layout.html">Scheam Design</a></li>
                  <li><a id="dsdb-concepts-insights-tradeoffs" class="" href="/dsdb/concepts/insights_tradeoffs.html">Insights Tradeoffs</a></li>
                  <li><a id="dsdb-concepts-api-endpoints" class="" href="/dsdb/concepts/api.html">API Endpoints&Ports</a></li>
                  <li><a id="dsdb-concepts-storage-engine" class="" href="/dsdb/concepts/storage_engine.html">Storage Engine</a></li>
                  <li><a id="dsdb-concepts-glossary" class="" href="/dsdb/concepts/glossary.html">Glossary of Terms</a></li>
                  <li><a id="dsdb-concepts-vs-sql" class="" href="/dsdb/concepts/crosswalk.html">Comparison to SQL</a></li>
                </ul>
              </li>
              <li><a class="fold">Data Sources</a>
                <ul class="menu3" >
                  <li><a id="dsdb-datasource-diamond" class="" href="/dsdb/data_sources/diamond.html">Diamond</a></li>
                  <li><a id="dsdb-datasource-opentsdb" class="" href="/dsdb/data_sources/opentsdb.html">OpenTSDB</a></li>
                </ul>
              </li>
              <li><a class="fold">Guides</a>
                <ul class="menu3" >
                  <li><a id="dsdb-guides-clustering" class="" href="/dsdb/guides/clustering.html">Clustering</a></li>
                  <li><a id="dsdb-guides-ddr" class="" href="/dsdb/guides/downsampling_and_retention.html">Downsampling and Data Retention</a></li>
                  <li><a id="dsdb-guides-hsg" class="" href="/dsdb/guides/hardware_sizing.html">Hardware Sizing Guidelines</a></li>
                  <li><a id="dsdb-guides-querying" class="" href="/dsdb/guides/querying_data.html">Querying Data</a></li>
                  <li><a id="dsdb-guides-writing" class="" href="/dsdb/guides/writing_data.html">Writing Data</a></li>
                </ul>
              </li>
              <li><a class="fold">Query Language</a>
                <ul class="menu3" >
                  <li><a id="dsdb-querylang-overview" class="" href="/dsdb/query_language/index.html">Overview</a></li>
                  <li><a id="dsdb-querylang-dataexp" class="" href="/dsdb/query_language/data_exploration.html">Data Exploration</a></li>
                  <li><a id="dsdb-querylang-scheamexp" class="" href="/dsdb/query_language/schema_exploration.html">Schema Exploration</a></li>
                  <li><a id="dsdb-querylang-func" class="" href="/dsdb/query_language/functions.html">Functions</a></li>
                  <li><a id="dsdb-querylang-contq" class="" href="/dsdb/query_language/continuous_queries.html">Continuous Queries</a></li>
                  <li><a id="dsdb-querylang-spec" class="" href="/dsdb/query_language/spec.html">Query Language Reference</a></li>
                  <li><a id="dsdb-querylang-mgmt" class="" href="/dsdb/query_language/database_management.html">Database Management</a></li>
                  <li><a id="dsdb-querylang-math" class="" href="/dsdb/query_language/math_operators.html">Mathematical Operators</a></li>
                </ul>
              </li>
              <li><a class="fold">Sample Data</a>
                <ul class="menu3" >
                  <li><a id="dsdb-sampledata-down" class="" href="/dsdb/sample_data/data_download.html">Sample Data Download</a></li>
                </ul>
              </li>
              <li><a class="fold">Tools</a>
                <ul class="menu3" >
                  <li><a id="dsdb-tools-overview" class="" href="/dsdb/tools/index.html">Tools Overview</a></li>
                  <li><a id="dsdb-tools-shell" class="" href="/dsdb/tools/shell.html">CLI/Shell</a></li>
                  <li><a id="dsdb-tools-webadmin" class="" href="/dsdb/tools/web_admin.html">Web Admin Interface</a></li>
                </ul>
              </li>
              <li><a class="fold">Write Protocols</a>
                <ul class="menu3" style="display: block;">
                  <li><a id="dsdb-writepro-overview" class="" href="/dsdb/write_protocols/index.html">Overview</a></li>
                  <li><a id="dsdb-writepro-line" class="" href="/dsdb/write_protocols/line.html">Line Protocol</a></li>
                  <li><a id="dsdb-writepro-syntax" class="" href="/dsdb/write_protocols/write_syntax.html">Write Syntax</a></li>
                  <li><a id="dsdb-writepro-json" class="" href="/dsdb/write_protocols/json.html">JSON Protocol</a></li>
                  <li><a id="dsdb-writepro-udp" class="active" href="/dsdb/write_protocols/udp.html">Service - UDP</a></li>
                  <li><a id="dsdb-writepro-graphite" class="" href="/dsdb/write_protocols/graphite.html">Service - Graphite</a></li>
                  <li><a id="dsdb-writepro-opentsdb" class="" href="/dsdb/write_protocols/opentsdb.html">Servcie - OpenTSDB</a></li>
                  <li><a id="dsdb-writepro-collectd" class="" href="/dsdb/write_protocols/collectd.html">Service - CollectD</a></li>
                </ul>
              </li>
              <li><a class="fold">Troubleshooting</a>
                <ul class="menu3" >
                  <li><a id="dsdb-troubleshoot-overview" class="" href="/dsdb/troubleshooting/index.html">Troubleshooting Overview</a></li>
                  <li><a id="dsdb-troubleshoot-fei" class="" href="/dsdb/troubleshooting/frequently_encountered_issues.html">Frequently Encountered Issues</a></li>
                  <li><a id="dsdb-troubleshoot-monitor" class="" href="/dsdb/troubleshooting/system_monitoring.html">System Monitoring</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li><a class="fold">DSD API Container(DAC)</a>
            <ul class="menu2" >
              <li><a id="dac-principal" class="" href="/dac/index.html">DAC介绍</a></li>
              <li><a id="dac-java-api" class="" href="/dac/dac_cloud_api_java.html">DAC Java API</a></li>
              <li><a id="dac-c-api" class="" href="/dac/dac_cloud_api_c.html">DAC C API</a></li>
              <li><a id="dac-cpp-api" class="" href="/dac/dac_cloud_api_cpp.html">DAC C++ API</a></li>
            </ul>
          </li>
          <li><a class="fold">Data Hub</a>
            <ul class="menu2" >
              <li><a id="datahub-index" class="" href="/datahub/index.html">Data Hub Overview</a></li>
              <li><a class="fold">SDK</a>
                <ul class="menu3" >
                  <li><a id="datahub-sdk-js" class="" href="/datahub/sdk/javascript.html">JavaScript</a></li>
                  <li><a id="datahub-sdk-embededc" class="" href="/datahub/sdk/embeded_c.html">Embeded C</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li><a class="fold">大数点云账户系统AAA</a>
            <ul class="menu2" >
              <li><a id="aaa-overview" class="" href="/aaa/index.html">AAA介绍</a></li>
              <li><a id="aaa-api" class="" href="/aaa/api.html">AAA API</a></li>
            </ul>
          </li>
          <li><a class="fold">大数点云存储服务CloudFile</a>
            <ul class="menu2" >
              <li><a id="cf-overview" class="" href="/cloudfile/index.html">CloudFile介绍</a></li>
              <li><a id="cf-api" class="" href="/cloudfile/api.html">CloudFile API</a></li>
            </ul>
          </li>
        </ul>
    </div>

    <div class="side_right">
      <div class="doc">
        <h1 id="service---udp">Service - UDP</h1>
<p>DSDB accepts writes over UDP.
By default, no ports are open to UDP.
To configure DSDB to support writes over UDP you must adjust your config file.</p>
<h2 id="a-note-on-udpip-os-buffer-sizes">A note on UDP/IP OS Buffer sizes</h2>
<p>Some OSes (most notably, Linux) place very restricive limits on the performance of UDP protocols.
Recent versions of FreeBSD, OSX, and Windows do not have this problem.
It is <em>highly</em> recommended that you increase these OS limits to 8MB before trying to run large amounts of UDP traffic to your instance.
8MB is a starting recommendation, and should be adjusted to be in line with your <code>read-buffer</code> plugin setting.</p>
<h3 id="linux">Linux</h3>
<p>Check the current UDP/IP read buffer limit by typing the following commands:</p>
<pre><code>sysctl net.core.rmem_max</code></pre>
<p>If the value is less than 8388608 bytes you should add the following lines to the /etc/sysctl.conf file:</p>
<pre><code>net.core.rmem_max=8388608</code></pre>
<p>Changes to /etc/sysctl.conf do not take effect until reboot.
To update the values immediately, type the following commands as root:</p>
<pre><code>sysctl -w net.core.rmem_max=8388608</code></pre>
<h3 id="bsddarwin">BSD/Darwin</h3>
<p>On BSD/Darwin systems you need to add about a 15% padding to the kernel limit socket buffer.
Meaning if you want an 8MB buffer (8388608 bytes) you need to set the kernel limit to <code>8388608*1.15 = 9646900</code>.
This is not documented anywhere but happens <a href="https://github.com/freebsd/freebsd/blob/master/sys/kern/uipc_sockbuf.c#L63-L64">in the kernel here.</a></p>
<p>Check the current UDP/IP buffer limit by typing the following command:</p>
<pre><code>sysctl kern.ipc.maxsockbuf</code></pre>
<p>If the value is less than 8388608 bytes you should add the following lines to the /etc/sysctl.conf file (create it if necessary):</p>
<pre><code>kern.ipc.maxsockbuf=8388608</code></pre>
<p>Changes to /etc/sysctl.conf do not take effect until reboot.
To update the values immediately, type the following commands as root:</p>
<pre><code>sysctl -w kern.ipc.maxsockbuf=8388608</code></pre>
<p>See <a href="https://access.redhat.com/documentation/en-US/JBoss_Enterprise_Web_Platform/5/html/Administration_And_Configuration_Guide/jgroups-perf-udpbuffer.html">here</a> for instructions on other OSes.</p>
<h3 id="using-the-read-buffer-option-for-the-udp-listener">Using the read-buffer option for the UDP listener</h3>
<p>The <code>read-buffer</code> option allows users to set the buffer size for the UDP listener.
It Sets the size of the operating system's receive buffer associated with the UDP traffic.
Keep in mind that the OS must be able to handle the number set here or the UDP listener will error and exit.</p>
<p><code>read-buffer = 0</code> means to use the OS default, which is usually too small for high UDP performance.</p>
<h2 id="config-file">Config File</h2>
<p>The target database and listening port for all UDP writes must be specified in the configuration file.</p>
<pre><code>...

[[udp]]
  enabled = true
  bind-address = ":8089" # the bind address
  database = "foo" # Name of the database that will be written to
  batch-size = 1000 # will flush if this many points get buffered
  batch-timeout = "1s" # will flush at least this often even if the batch-size is not reached
  batch-pending = 5 # number of batches that may be pending in memory
  read-buffer = 0 # UDP Read buffer size, 0 means OS default. UDP listener will fail if set above OS max.
...</code></pre>
<p>Multiple configurations can be specified to support multiple listening ports or multiple target databases.
For example:</p>
<pre><code>...
[[udp]]
  # Default UDP for Telegraf
  enabled = true
  bind-address = ":8089" # the bind address
  database = "telegraf" # Name of the database that will be written to
  batch-size = 5000 # will flush if this many points get buffered
  batch-timeout = "1s" # will flush at least this often even if the batch-size is not reached
  batch-pending = 10 # number of batches that may be pending in memory
  read-buffer = 0 # UDP read buffer size, 0 means to use OS default

[[udp]]
  # High-traffic UDP
  enabled = true
  bind-address = ":80891" # the bind address
  database = "mymetrics" # Name of the database that will be written to
  batch-size = 5000 # will flush if this many points get buffered
  batch-timeout = "1s" # will flush at least this often even if the batch-size is not reached
  batch-pending = 100 # number of batches that may be pending in memory
  read-buffer = 8388608 # (8*1024*1024) UDP read buffer size
...</code></pre>
<h2 id="writing-points">Writing Points</h2>
<p>To write, just send newline separated <a href="/dsdb/write_protocols/line.html">line protocol</a> over UDP.
For better performance send batches of points rather than multiple single points.</p>
<pre><code class="language-bash">$ echo "cpu value=1"&gt; /dev/udp/localhost/8089</code></pre>
<h2 id="more-information">More Information</h2>
<p>For more information about the UDP plugin, please see the UDP plugin <a href="https://github.com/dsdb/dsdb/blob/master/services/udp/index.html">README</a>.</p>
      </div>

              <div class="tract"><img src="/images/tract.png"/></div>
            <div class="clearfix"></div>
      <div class="scroll" id="scroll" style="display:none;">
			     <img src="/images/top.png"/>
		  </div>
    </div>
  </div>
  <script>hljs.initHighlightingOnLoad();</script>
</body>

</html>
